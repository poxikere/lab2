open System

let random = Random()
let rec vvodRandom acc =
    printf "Сколько цифр сгенерировать?"
    let input1 = Console.ReadLine()
    match Int32.TryParse(input1) with
    | true, num -> List.init num (fun _ -> random.Next(1, 10).ToString())
    | false, _ ->
        printfn "Некорректный ввод"
        vvodRandom acc

let rec vvodSam acc =
    printf "Введите цифру (или 'net' для выхода): "
    let input = Console.ReadLine()
    match input with
    | "net" -> List.rev acc
    | s ->
        match Int32.TryParse(s) with
        | true, num -> (if num<10 && num>0 then vvodSam (input :: acc)
            else printfn "Некорректный ввод. Пожалуйста, введите цифру или 'net'."
                 vvodSam acc)
        | false, _ ->
            printfn "Некорректный ввод. Пожалуйста, введите цифру или 'net'."
            vvodSam acc

let rec vvod acc =
    printf "Ввеси рандомом (r) или вручную (s)?"
    let input = Console.ReadLine()
    match input with
    | "s" -> vvodSam
    | "r" -> vvodRandom
    | _ -> 
        printfn "Некорректный ввод"
        vvod acc

let rim x =
    match x with
    | "1" -> "I"
    | "2" -> "II"
    | "3" -> "III"
    | "4" -> "IV"
    | "5" -> "V"
    | "6" -> "VI"
    | "7" -> "VII"
    | "8" -> "VIII"
    | _ -> "IX"

let smena xx =
    xx |> List.map (rim)

let list1 = vvod()
let list2 = smena list1[]
printfn "Римские цифры: %A" list2
